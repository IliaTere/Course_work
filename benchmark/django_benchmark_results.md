# Результаты бенчмарка для Django-тестов

В данном документе представлены результаты бенчмарка, демонстрирующие влияние размера базы данных на скорость получения конкретного пользователя в Django-подобном приложении.

## Ключевые выводы

1. **Для запросов по первичному ключу (ID) размер базы данных практически не влияет на скорость**:
   - При запросе по ID скорость остается стабильной даже при увеличении размера базы данных в 10000 раз
   - Небольшие колебания результатов находятся в пределах статистической погрешности

2. **Для запросов по неиндексированным полям наблюдается линейная зависимость от размера базы**:
   - При запросе по неиндексированному полю `name` скорость деградирует примерно пропорционально размеру базы
   - Для базы данных в 100 000 записей запрос медленнее в ~26 раз по сравнению с базой в 10 записей

3. **Индексирование полей устраняет зависимость скорости от размера базы**:
   - При наличии индекса по полю `name` скорость запроса не снижается даже при 100 000 записей
   - Для больших баз данных (100 000 записей) запрос по индексированному полю быстрее в ~39 раз чем по неиндексированному

## Детальные результаты

### Запрос по первичному ключу (ID)

| Размер БД | Среднее время (мс) | Отношение к базе 10 записей |
|-----------|---------------------|---------------------------|
| 10        | 0.124               | 1.00x (базовая линия)     |
| 100       | 0.155               | 1.24x медленнее           |
| 1000      | 0.150               | 1.20x медленнее           |
| 10000     | 0.135               | 1.09x медленнее           |
| 100000    | 0.146               | 1.17x медленнее           |

### Запрос по имени с индексом

| Размер БД | Среднее время (мс) | Отношение к базе 10 записей |
|-----------|---------------------|---------------------------|
| 10        | 0.118               | 1.00x (базовая линия)     |
| 100       | 0.168               | 1.43x медленнее           |
| 1000      | 0.120               | 1.02x медленнее           |
| 10000     | 0.125               | 1.06x медленнее           |
| 100000    | 0.121               | 1.03x медленнее           |

### Запрос по имени без индекса

| Размер БД | Среднее время (мс) | Отношение к базе 10 записей |
|-----------|---------------------|---------------------------|
| 10        | 0.181               | 1.00x (базовая линия)     |
| 100       | 0.155               | 0.86x быстрее             |
| 1000      | 0.197               | 1.09x медленнее           |
| 10000     | 0.594               | 3.28x медленнее           |
| 100000    | 4.720               | 26.10x медленнее          |

### Сравнение запросов с индексом и без индекса

| Размер БД | Без индекса (мс) | С индексом (мс) | Ускорение |
|-----------|----------------|----------------|----------|
| 10        | 0.181          | 0.118          | 1.54x    |
| 100       | 0.155          | 0.168          | 0.92x    |
| 1000      | 0.197          | 0.120          | 1.65x    |
| 10000     | 0.594          | 0.125          | 4.76x    |
| 100000    | 4.720          | 0.121          | 38.93x   |

## Выводы для Django тестов

1. **Тесты, запрашивающие пользователей по первичному ключу (ID)**, не будут существенно замедляться при увеличении размера базы данных, поскольку первичный ключ всегда индексируется.

2. **Тесты, запрашивающие пользователей по неиндексированным полям**, будут существенно замедляться при увеличении размера базы данных. Разница может достигать более 26 раз при сравнении базы с 10 и 100 000 записями.

3. **Для эффективной работы тестов**:
   - Используйте миграции с индексами для полей, по которым часто выполняются запросы
   - Для тестов создавайте только необходимые записи в базе данных
   - Используйте фабрики и фикстуры которые создают минимальный набор данных, нужный для теста
   - Рассмотрите возможность использовать небольшую тестовую базу данных вместо копии производственной

4. **Оптимальный подход для Django тестов**:
   - Когда тесты запрашивают записи по первичному ключу или индексированным полям, размер базы данных не имеет значения
   - Когда тесты запрашивают записи по неиндексированным полям, скорость тестов будет существенно зависеть от размера базы данных

## Заключение

Результаты бенчмарка подтверждают, что для запросов по индексированным полям (включая первичный ключ) размер базы данных оказывает незначительное влияние на производительность. Для неиндексированных полей производительность линейно деградирует с ростом размера базы данных.

Для Django-тестов рекомендуется использовать небольшие базы данных с минимальным набором необходимых записей или убедиться, что все поля, используемые в запросах, проиндексированы. 